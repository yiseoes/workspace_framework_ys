<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>07jQueryAjaxETC-orderClient</title>

  <!-- jQuery 2.1.4 -->
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

  <style>
    body { font-family: Arial, "ë§‘ì€ ê³ ë”•", sans-serif; margin: 24px; }
    .row { margin-bottom: 12px; }
    label { display:inline-block; width:80px; }
    input[type="text"] { width: 240px; padding: 6px; }
    textarea { width: 332px; height: 140px; padding: 8px; }
    .btn { padding: 8px 14px; cursor: pointer; margin-right: 8px; margin-bottom: 8px; }
    .group { margin: 6px 0 14px; }
  </style>

  <script type="text/javascript">
    // ===== ê³µí†µ ìœ í‹¸ =====
    var URL = "postJSON-orderServer.jsp"; // GET/POST ëª¨ë‘ JSON ë¬¸ìì—´(or JSON) ì‘ë‹µí•œë‹¤ê³  ê°€ì •

    function buildDisplayValue(obj){
      return "ì´ë¦„  : " + (obj.name    || "") + "\n"
           + "ì „í™” : " + (obj.phone   || "") + "\n"
           + "ì£¼ì†Œ : " + (obj.address || "");
    }

    function toObjectFromText(serverText){
      // ì„œë²„ê°€ ìˆœìˆ˜ JSON ë¬¸ìì—´ì„ ë³´ë‚¸ë‹¤ëŠ” ì „ì œ
      try {
        return $.parseJSON(serverText);
      } catch(e){
        alert("JSON íŒŒì‹± ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ ã… ã… \n" + e);
        return null;
      }
    }

    function fillResult(obj){
      var displayValue = buildDisplayValue(obj);
      $("#address").val(displayValue);
    }

    $(function(){

      $("#orderForm").on("submit", function(e){ e.preventDefault(); });
      $("#orderForm")[0].reset();

      // ===== 1) ì˜µì…˜í˜• .ajax() : POST + text ìˆ˜ì‹ (ì§ì ‘ íŒŒì‹±) =====
      $("#btnAjaxPostText").on("click", function(){
        var name  = $.trim($("#name").val());
        var phone = $.trim($("#phone").val());
        if(!name || !phone){ alert("ì´ë¦„/ì „í™” ì…ë ¥í•´ì¤˜ ğŸ˜Š"); return; }

        $.ajax({
          url: URL,
          type: "POST",
          dataType: "text",                  // ë¬¸ìì—´ ìˆ˜ì‹ 
          data: { name: name, phone: phone },
          success: function(serverText){
            // â”€â”€ ì¤‘ê°„ ì•ŒëŸ¿ 1 : ì„œë²„ ì›ë¬¸ ë¬¸ìì—´ â”€â”€
            alert("Serverì—ì„œ ë°›ì€ ë‚´ìš© : \n" + serverText);

            var JSONData = toObjectFromText(serverText);
            if(!JSONData) return;

            // â”€â”€ ì¤‘ê°„ ì•ŒëŸ¿ 2 : íŒŒì‹±ëœ JSON í•„ë“œ â”€â”€
            alert(
              "JSONData : \n"
              + "ì´ë¦„  : " + (JSONData.name || "") + "\n"
              + "ì „í™” : " + (JSONData.phone || "") + "\n"
              + "ì£¼ì†Œ : " + (JSONData.address || "")
            );

            // â”€â”€ ê²°ê³¼ì°½ í‘œì‹œ â”€â”€
            fillResult(JSONData);
          },
          error: function(req, status, err){
            alert("ì—ëŸ¬ ë°œìƒ : " + req.status + "\n" + (err || ""));
          }
        });
      });

   // [2) ì˜µì…˜í˜• .ajax() : POST + json ìˆ˜ì‹ (ìë™ íŒŒì‹±)]
      $("#btnAjaxPostJson").on("click", function(){
        var name  = $.trim($("#name").val());
        var phone = $.trim($("#phone").val()); // â† ê´„í˜¸ í•˜ë‚˜ ì œê±°
        if(!name || !phone){ alert("ì´ë¦„/ì „í™” ì…ë ¥í•´ì¤˜ ğŸ˜Š"); return; }

        $.ajax({
          url: URL,
          type: "POST",
          dataType: "json",
          data: { name: name, phone: phone },
          success: function(JSONData){
            alert(
              "Serverì—ì„œ ë°›ì€ ë‚´ìš©(JSON) : \n"
              + "ì´ë¦„  : " + (JSONData.name || "") + "\n"
              + "ì „í™” : " + (JSONData.phone || "") + "\n"
              + "ì£¼ì†Œ : " + (JSONData.address || "")
            );
            alert(
              "JSONData : \n"
              + "ì´ë¦„  : " + (JSONData.name || "") + "\n"
              + "ì „í™” : " + (JSONData.phone || "") + "\n"
              + "ì£¼ì†Œ : " + (JSONData.address || "")
            );
            fillResult(JSONData);
          },
          error: function(req, status, err){
            alert("ì—ëŸ¬ ë°œìƒ : " + req.status + "\n" + (err || ""));
          }
        });
      });


      // ===== 3) ìˆí•¸ë“œ $.get() : GET + text ìˆ˜ì‹ (ì§ì ‘ íŒŒì‹±) =====
      $("#btnGetText").on("click", function(){
        var name  = $.trim($("#name").val());
        var phone = $.trim($("#phone").val());
        if(!name || !phone){ alert("ì´ë¦„/ì „í™” ì…ë ¥í•´ì¤˜ ğŸ˜Š"); return; }

        $.get(URL, { name: name, phone: phone }, function(serverText){
          // â”€â”€ ì¤‘ê°„ ì•ŒëŸ¿ 1 â”€â”€
          alert("Serverì—ì„œ ë°›ì€ ë‚´ìš© : \n" + serverText);

          var JSONData = toObjectFromText(serverText);
          if(!JSONData) return;

          // â”€â”€ ì¤‘ê°„ ì•ŒëŸ¿ 2 â”€â”€
          alert(
            "JSONData : \n"
            + "ì´ë¦„  : " + (JSONData.name || "") + "\n"
            + "ì „í™” : " + (JSONData.phone || "") + "\n"
            + "ì£¼ì†Œ : " + (JSONData.address || "")
          );

          fillResult(JSONData);
        }, "text")
        .fail(function(req, status, err){
          alert("ì—ëŸ¬ ë°œìƒ : " + req.status + "\n" + (err || ""));
        });
      });

      // ===== 4) ìˆí•¸ë“œ $.post() : POST + json ìˆ˜ì‹ (ìë™ íŒŒì‹± ì§€ì •) =====
      $("#btnPostJson").on("click", function(){
        var name  = $.trim($("#name").val());
        var phone = $.trim($("#phone").val());
        if(!name || !phone){ alert("ì´ë¦„/ì „í™” ì…ë ¥í•´ì¤˜ ğŸ˜Š"); return; }

        $.post(URL, { name: name, phone: phone }, function(JSONData){
          // â”€â”€ ì¤‘ê°„ ì•ŒëŸ¿ 1 â”€â”€
          alert(
            "Serverì—ì„œ ë°›ì€ ë‚´ìš©(JSON) : \n"
            + "ì´ë¦„  : " + (JSONData.name || "") + "\n"
            + "ì „í™” : " + (JSONData.phone || "") + "\n"
            + "ì£¼ì†Œ : " + (JSONData.address || "")
          );

          // â”€â”€ ì¤‘ê°„ ì•ŒëŸ¿ 2 â”€â”€
          alert(
            "JSONData : \n"
            + "ì´ë¦„  : " + (JSONData.name || "") + "\n"
            + "ì „í™” : " + (JSONData.phone || "") + "\n"
            + "ì£¼ì†Œ : " + (JSONData.address || "")
          );

          fillResult(JSONData);
        }, "json")
        .fail(function(req, status, err){
          alert("ì—ëŸ¬ ë°œìƒ : " + req.status + "\n" + (err || ""));
        });
      });

      // ===== 5) ìˆí•¸ë“œ $.getJSON() : GET + json ìˆ˜ì‹  =====
      $("#btnGetJSON").on("click", function(){
        var name  = $.trim($("#name").val());
        var phone = $.trim($("#phone").val());
        if(!name || !phone){ alert("ì´ë¦„/ì „í™” ì…ë ¥í•´ì¤˜ ğŸ˜Š"); return; }

        $.getJSON(URL, { name: name, phone: phone }, function(JSONData){
          // â”€â”€ ì¤‘ê°„ ì•ŒëŸ¿ 1 â”€â”€
          alert(
            "Serverì—ì„œ ë°›ì€ ë‚´ìš©(JSON) : \n"
            + "ì´ë¦„  : " + (JSONData.name || "") + "\n"
            + "ì „í™” : " + (JSONData.phone || "") + "\n"
            + "ì£¼ì†Œ : " + (JSONData.address || "")
          );

          // â”€â”€ ì¤‘ê°„ ì•ŒëŸ¿ 2 â”€â”€
          alert(
            "JSONData : \n"
            + "ì´ë¦„  : " + (JSONData.name || "") + "\n"
            + "ì „í™” : " + (JSONData.phone || "") + "\n"
            + "ì£¼ì†Œ : " + (JSONData.address || "")
          );

          fillResult(JSONData);
        })
        .fail(function(req, status, err){
          alert("ì—ëŸ¬ ë°œìƒ : " + req.status + "\n" + (err || ""));
        });
      });

    });
  </script>
</head>

<body>
  <h2>07jQueryAjaxETC-orderClient</h2>

  <form id="orderForm">
    <div class="row">
      <label for="name">ì´ë¦„</label>
      <input type="text" id="name" name="name" placeholder="â™¥ì´ë¦„ ì…ë ¥â™¥">
    </div>
    <div class="row">
      <label for="phone">ì „í™”</label>
      <input type="text" id="phone" name="phone" placeholder="â™¥ë²ˆí˜¸ ì…ë ¥â™¥">
    </div>

    <div class="group">
      <strong>.ajax(options)</strong><br/>
      <button id="btnAjaxPostText" class="btn" type="button">POST (text ìˆ˜ì‹ )</button>
      <button id="btnAjaxPostJson" class="btn" type="button">POST (JSON ìˆ˜ì‹ )</button>
    </div>

    <div class="group">
      <strong>Shorthand</strong><br/>
      <button id="btnGetText"  class="btn" type="button">$.get (text ìˆ˜ì‹ )</button>
      <button id="btnPostJson" class="btn" type="button">$.post (JSON ìˆ˜ì‹ )</button>
      <button id="btnGetJSON"  class="btn" type="button">$.getJSON (JSON ìˆ˜ì‹ )</button>
    </div>

    <div class="row">
      <label for="address">ê²°ê³¼</label><br/>
      <textarea id="address" placeholder="â˜…ì„œë²„ ì‘ë‹µ íŒŒì‹± ê²°ê³¼ ì¶œë ¥â˜…" readonly></textarea>
    </div>
  </form>
</body>
</html>
